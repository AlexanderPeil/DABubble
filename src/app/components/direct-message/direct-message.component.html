<div [ngClass]="{ 'chatHistoryFullWidth': toggleWorspaceMenuService.workspaceMenuIsOpen || threadService.threadAreClosed }"
    class="chatHistoryMainContainer">
    <div class="chatHistoryHeader">
        <div class="userName" (click)="openDialog()">
            <div class="userIconWrapper">
                <img class="userImg" [src]="selectedUser?.photoURL" alt="">
                <img *ngIf="selectedUser?.isOnline" class="statusIcon" src="../../../assets/img/icons/user_online.svg"
                    alt="Online" />
                <img *ngIf="!selectedUser?.isOnline" class="statusIcon" src="../../../assets/img/icons/user_offline.svg"
                    alt="Offline" />
            </div>
            <p>{{ selectedUser?.displayName }}</p>
        </div>
    </div>


    <!-- Message container -->
    <div class="messagesContainer scrolleableContainer">
        <div *ngFor="let group of groupMessagesByDate(messages)" class="directMesageContainer">
            <div class="date">
                <hr>
                <span>{{ group.date }}</span>
                <hr>
            </div>
            <div *ngFor="let message of group.messages" class="messageMainContainer">
                <div class="messageChildContainer">
                    <img class="userImg"
                        [src]="message.senderId === loggedInUser?.uid ? loggedInUser?.photoURL : selectedUser?.photoURL">

                    <div class="containerUserNameAndTime">
                        <div class="nameTimeContainer">
                            <p>{{ message.senderId === loggedInUser?.uid ? loggedInUser?.displayName :
                                selectedUser?.displayName }}</p>
                            <p>{{ formatTime(message.timestamp) }}</p>
                        </div>
                        <span class="message">{{ message.content }}</span>
                    </div>
                </div>

                <!-- Emoji container -->
                <div class="containerEmojis d-none">
                    <img class="completeEmoji" src="assets/img/icons/completeEmoji.svg">
                    <img class="handsUpEmoji" src="assets/img/icons/handsUpEmoji.svg">
                    <div class="containerAddEmojiIcon">
                        <img class="addEmojiIcon" src="assets/img/icons/addEmojiIcon.svg">
                    </div>
                    <div class="containerAnswerOnThreadIcon">
                        <img (click)="threadService.openThreadService()" class="answerOnThreadIcon"
                            src="assets/img/icons/answerOnThreadIcon.svg">
                    </div>
                </div>
            </div>


        </div>
    </div>
    <!-- Message container -->


    <!-- Message textarea -->
    <!-- <div class="containerTextarea"> -->
    <!-- <textarea [(ngModel)]="messageContent" placeholder="Write a message..."
            (input)="checkForAtSymbol($event)"></textarea>

        <div *ngIf="showUserDropdown" class="user-dropdown scrolleableContainer" #userMenu>
            <div *ngFor="let user of foundUsers" (click)="selectUser(user)">
                <img [src]="user.photoURL">
                <span>{{ user.displayName }}</span>
            </div>
        </div>
        <img class="addIcon" src="assets/img/icons/add.svg">
        <hr>
        <img class="smileyIcon smileyIconHover" src="assets/img/icons/smiley.svg" (click)="toggleEmojiPicker($event)">
        <div class="smileyIcon smileyContainer" *ngIf="showEmojiPicker" #emojiContainer>
            <emoji-mart (emojiClick)="addEmoji($event)"></emoji-mart>
        </div>
        <img class="atIcon" src="assets/img/icons/@Icon.svg" (click)="triggerAtSymbol($event)">
        <img (click)="sendMessage()" class="sendBtn" src="assets/img/icons/sendBtn.svg"> -->
    <!-- </div> -->
    <!-- Message textarea -->


    <!-- [formControl]="messageFormControl"   (contentChanged)="onTextChange($event)"  (onFocus)="onEditorFocus($event)"  -->
    <!-- Message textarea -->
    <quill-editor [(ngModel)]="messageContent" placeholder="Write a message" (onEditorCreated)="setFocus($event)"
        (onContentChanged)="onTextChange($event)">
        <div quill-editor-toolbar>
            <div *ngIf="showUserDropdown" class="user-dropdown scrolleableContainer" #userMenu>
                <div *ngFor="let user of foundUsers" (click)="selectUser(user)">
                    <img [src]="user.photoURL">
                    <span>{{ user.displayName }}</span>
                </div>
            </div>

            <!--------------------------------------- Custom created Container --------------------------------------->
            <div class="mainContainerUploadedDatas">
                <!--------------------------------------- Displays uploaded Images --------------------------------------->
                <div *ngFor="let uploadedImage of storageService.uploadedImages; let i = index"
                    class="containerUploadedImages">
                    <img class="uploadedImage" [src]="uploadedImage ? uploadedImage : null">
                    <img matTooltipPosition="above" matTooltip="Delete Data"
                        (click)="this.storageService.deleteUploadedDataService(uploadedImage, i)" class="closeIcon"
                        src="assets/img/icons/closeIcon.svg">
                </div>
                <!--------------------------------------- Displays uploaded Images --------------------------------------->


                <!--------------------------------------- Displays uploaded Datas, like PDF --------------------------------------->
                <div *ngFor="let uploadedData of storageService.uploadedDatas; let i = index"
                    class="containerUploadedDatas">
                    <iframe class="uploadedData" [src]="uploadedData ? uploadedData : null"></iframe>
                    <img matTooltipPosition="above" matTooltip="Delete Data"
                        (click)="this.storageService.deleteUploadedDataService(uploadedData, i)" class="closeIcon"
                        src="assets/img/icons/closeIcon.svg">
                </div>
                <!--------------------------------------- Displays uploaded Datas, like PDF --------------------------------------->
            </div>

            <div class="smileyIcon smileyContainer" *ngIf="showEmojiPicker" #emojiContainer>
                <emoji-mart (emojiClick)="addEmoji($event)"></emoji-mart>
            </div>

            <div class="containerIcons">
                <label for="input" class="containerAddIcon">
                    <img src="assets/img/icons/add.svg" />
                    <input (change)="chooseFiletoUpload($event)" id="input" type="file" hidden />
                </label>

                <hr class="verticalLine" />

                <div class="containerSmileyIcon">
                    <img class="smileyIcon" src="assets/img/icons/smiley.svg" (click)="toggleEmojiPicker($event)" />
                </div>


                <div class="containerAtIcon">
                    <img class="atIcon" src="assets/img/icons/@Icon.svg" (click)="triggerAtSymbol($event)" />
                </div>
                <img (click)="sendMessage()" class="sendBtn" src="assets/img/icons/sendBtn.svg" />
            </div>
            <!--------------------------------------- Custom created Container --------------------------------------->

            <!-- <img class="addIcon" src="assets/img/icons/add.svg">
            <hr>
            <img class="smileyIcon smileyIconHover" src="assets/img/icons/smiley.svg"
                (click)="toggleEmojiPicker($event)">
            <div class="smileyIcon smileyContainer" *ngIf="showEmojiPicker" #emojiContainer>
                <emoji-mart (emojiClick)="addEmoji($event)"></emoji-mart>
            </div>
            <img class="atIcon" src="assets/img/icons/@Icon.svg" (click)="triggerAtSymbol($event)">
            <img (click)="sendMessage()" class="sendBtn" src="assets/img/icons/sendBtn.svg"> -->

        </div>
    </quill-editor>
    <!-- Message textarea -->

</div>